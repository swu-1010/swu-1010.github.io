"use strict";(self["webpackChunkbookstore_app"]=self["webpackChunkbookstore_app"]||[]).push([[990],{11990:function(t,e,o){o.r(e),o.d(e,{default:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"favor"},[e("van-nav-bar",{attrs:{"left-arrow":"",title:"我的收藏"+t.favorNum},on:{"click-left":function(e){return t.$router.back(-1)}}},[e("van-icon",{staticStyle:{"margin-right":"10px"},attrs:{slot:"right",name:"search"},slot:"right"}),e("span",{staticStyle:{"margin-right":"10px"},attrs:{slot:"right"},slot:"right"},[t._v("管理")])],1),""==this.$store.getters.getFavorNum?e("van-notice-bar",[t._v("您的收藏空空如也...")]):t._e(),e("div",{staticClass:"content"},[t._l(t.books,(function(o,s){return e("van-card",{key:s,attrs:{price:o.etc.book.price,desc:o.etc.book.author,title:o.etc.book.name,thumb:"/"+o.etc.book.img},on:{click:function(e){return t.toDetail(o.bookId)}},scopedSlots:t._u([{key:"tags",fn:function(){return[e("van-tag",{attrs:{plain:"",size:"large",type:"primary"}},[t._v(t._s(o.etc.book.publisher))]),e("br"),e("van-tag",{attrs:{type:"danger"}},[t._v(t._s(o.etc.cateName))])]},proxy:!0},{key:"tag",fn:function(){return[e("van-checkbox",{nativeOn:{click:function(e){return t.updateFavor(s,0)}},model:{value:t.checkedIds[s],callback:function(e){t.$set(t.checkedIds,s,e)},expression:"checkedIds[index]"}})]},proxy:!0},{key:"num",fn:function(){return[e("van-icon",{attrs:{name:"delete-o"},on:{click:function(e){return t.deleteFavor(o.bookId)}}})]},proxy:!0}],null,!0)})})),e("van-submit-bar",{attrs:{"button-text":"删除"},on:{submit:function(e){return t.deleteFavors()}}},[e("van-checkbox",{staticStyle:{width:"70%"},nativeOn:{click:function(e){return t.updateFavor(0,1)}},model:{value:t.allCheck,callback:function(e){t.allCheck=e},expression:"allCheck"}},[t._v("全选")])],1)],2)],1)},n=[],a=(o(57658),o(7877)),r={name:"favor",data:function(){return{searchValue:"",books:[],ids:[],allCheck:"",checkedIds:[],no:0}},methods:{checkAll(){let t=0;for(let e=0;e<this.checkedIds.length;e++){if(0==this.checkedIds[e]){this.allCheck=!1;break}t++,t==this.books.length&&(this.allCheck=!0)}},updateFavor(t,e){if(event.stopPropagation(),0==this.no){for(let t=0;t<this.books.length;t++)this.checkedIds[t]=!1;this.no++}if(0==e)this.checkedIds[t]=!this.checkedIds[t];else if(1==e){let t=0;for(let e=0;e<this.books.length;e++)1==this.checkedIds[e]&&t++;if(t==this.books.length)for(let e=0;e<this.books.length;e++)this.checkedIds[e]=!1;else for(let e=0;e<this.books.length;e++)0==this.checkedIds[e]&&(this.checkedIds[e]=!0)}this.checkAll()},toDetail(t){this.$router.push({name:"detail",query:{id:t}})},deleteFavor(t){let e=this;event.stopPropagation(),this.$dialog.confirm({title:"删除商品",message:"确认删除吗？"}).then((()=>{console.log("delete"),a.Z.deleteByIds("/favor/deleteByIds",t).then((function(t){e.getFavor()}))})).catch((()=>{}))},deleteFavors(){let t=[];for(let e=0;e<this.books.length;e++)1==this.checkedIds[e]&&t.push(this.books[e].bookId);console.log(t,"ids"),0!=t.length&&this.deleteFavor(t.join(","))},getFavor(){let t=this;a.Z.getUser("/user/getUser",localStorage.getItem("username")).then((function(e){200==e.statusCode?a.Z.getBooksByUserId("/favor/getByUserId",e.data.user.id).then((function(e){t.books=e.data,t.$store.dispatch("setFavorNum"),t.checkAll()})):401==e.statusCode&&(Toast("token过期"),t.$router.push("login"))}))}},created:function(){this.getFavor(),this.checkedIds.fill(!1),this.checkAll()},computed:{favorNum:function(){let t=this.$store.getters.getFavorNum;return t>0?"("+t+")":""}}},c=r,i=o(43736),l=(0,i.Z)(c,s,n,!1,null,"bb4aa4c8",null),h=l.exports}}]);
//# sourceMappingURL=990.6c4b4b9a.js.map