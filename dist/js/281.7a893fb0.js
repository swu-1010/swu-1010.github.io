"use strict";(self["webpackChunkbookstore_app"]=self["webpackChunkbookstore_app"]||[]).push([[281],{90281:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var l=function(){var e=this,t=e._self._c;return t("el-main",{staticClass:"manageOrder"},[t("div",[t("el-form",{ref:"searchForm",staticClass:"formItem",attrs:{model:e.searchForm,inline:!0,"label-width":"80px"}},[t("el-col",{attrs:{xl:6,md:8,sm:24}},[t("el-form-item",{attrs:{label:"用户名",prop:"title"}},[t("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1)],1),t("el-col",{attrs:{xl:6,md:8,sm:24}},[t("el-form-item",[t("div",{style:{float:"right",overflow:"hidden"}||{}},[t("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.search}},[e._v("搜索")])],1)])],1)],1)],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),t("el-button",{attrs:{type:"primary"},on:{click:e.delAll}},[e._v("批量删除")])],1),t("pageTable",{ref:"dataTable",attrs:{"row-key":"id"},on:{"load-table-data":e.loadTableData,"selection-change":e.selectionChange}},[t("template",{slot:"tb-columns"},[t("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center",width:"100"}}),t("el-table-column",{attrs:{prop:"nickname",label:"昵称",align:"center",width:"150"}}),t("el-table-column",{attrs:{prop:"privilege",label:"权限",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.privilege?t("div",[e._v("管理员")]):t("div",[e._v("普通用户")])]}}])}),t("el-table-column",{attrs:{prop:"telephone",label:"电话",align:"center",width:"200"}}),t("el-table-column",{attrs:{prop:"address",label:"地址","show-overflow-tooltip":!0,align:"center"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.edit(a.row)}}},[e._v("编辑")]),e._v(" ｜ "),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.delOne(a.row.id)}}},[e._v("删除")])]}}])})],1)],2),e.visible?t("EditUser",{attrs:{title:e.title,visible:e.visible,defaultFormData:e.defaultFormData},on:{close:e.close}}):e._e()],1)},r=[],o=(a(57658),a(7877)),i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,visible:e.visible,"before-close":e.close}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),t("el-form-item",{attrs:{label:"重置密码",prop:"password"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",{attrs:{label:"权限",prop:"privilege"}},[t("template",{slot:"default"},[1==e.form.privilege?t("el-button",{staticClass:"privilege",attrs:{type:"primary"}},[e._v("管理员")]):t("el-button",{staticClass:"privilege",attrs:{type:"primary"}},[e._v("普通用户")])],1)],2),t("el-form-item",{attrs:{label:"电话",prop:"telephone"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.telephone,callback:function(t){e.$set(e.form,"telephone",t)},expression:"form.telephone"}})],1),t("el-form-item",{attrs:{label:"地址",prop:"address"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.close}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},n=[],s=(a(16743),a(88848)),c={name:"editUser",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"新增"},defaultFormData:{type:Object}},data(){return{flag:!1,form:{},flag:!1,saveOrUpdate:!1,rules:{name:[{required:!0,message:"不能为空"}],value:[{required:!0,message:"不能为空",trigger:"blur"}]}}},mounted(){"{}"==JSON.stringify(this.defaultFormData)?(this.flag=!1,this.saveOrUpdate=!1):(this.form=JSON.parse(JSON.stringify(this.defaultFormData)),console.log(this.form),this.flag=!0,this.saveOrUpdate=!0)},methods:{close(){this.flag=!1,this.$emit("close",this.flag)},submit(){console.log(this.form);let e=this;o.Z.updateUser("/user/update",{...this.form}).then((t=>{console.log(t),e.flag=!0,e.$emit("close",e.flag),(0,s.Z)("更新成功")})).catch((t=>{console.log(t),e.flag=!1,e.$emit("close",e.flag)}))}}},d=c,u=a(1001),p=(0,u.Z)(d,i,n,!1,null,"1b0c10ce",null),m=p.exports,h=a(78066),f={name:"manageUser",components:{PageTable:h.Z,EditUser:m},data(){return{title:"新增",visible:!1,orderId:"",ids:"",searchForm:{username:""},defaultFormData:{}}},methods:{search(){this.$refs.dataTable.loadTableData("reload")},selectionChange(e){var t=[];for(var a of e)t.push(a.id);this.ids=t.join(",")},delAll(){this.ids.length<=0?this.$message({message:"请先选择记录",type:"warning"}):this.del(this.ids)},delOne(e){this.del(e)},del(e){this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{deleteByIds({ids:e}).then((e=>{this.$refs.dataTable.loadTableData("reload")})).catch((e=>{console.log(e)}))})).catch((()=>{}))},close(e){this.visible=!1,e&&this.$refs.dataTable.loadTableData("reload")},add(){this.visible=!0,this.defaultFormData={}},edit(e){this.visible=!0,this.title="编辑",this.defaultFormData=e},loadTableData(e,t){let a=this;o.Z.getUser("/user/getUser",localStorage.getItem("username")).then((function(l){200==l.statusCode?o.Z.getAll("/user/getAllUser",e.pageNum,e.pageSize).then((e=>{console.log(e);let a={data:e.data.records,total:e.data.total};t(a)})).catch((e=>{console.log(e)})):401==l.statusCode&&(Toast("token过期"),a.$router.push("login"))}))}}},g=f,b=(0,u.Z)(g,l,r,!1,null,"2f6b8d54",null),y=b.exports},78066:function(e,t,a){a.d(t,{Z:function(){return u}});var l=function(){var e=this,t=e._self._c;return t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"filterTable",attrs:{"max-height":"560",border:e.border,stripe:e.stripe,"header-cell-style":e.headerCellStyle,"highlight-current-row":"",data:e.tableData,"element-loading-text":"加载中...","tree-props":e.treeProps,"row-key":e.rowKey,"default-expand-all":e.defaultExpandAll},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick,"sort-change":e.handleSortChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._t("tb-columns")],2),t("el-row",{staticClass:"mt-15"},[t("el-col",{staticClass:"flex justify-end"},[t("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, sizes, jumper",total:e.total,"page-size":e.page.pageSize,"page-sizes":e.pageSizes,"current-page":e.current},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},r=[];const o={objectIndexInArray:(e,t,a)=>{let l=-1;for(let r in e)if(e[r][a]===t[a]){l=r;break}return l},isStatic:e=>"string"===typeof e||"number"===typeof e||"boolean"===typeof e||"undefined"===typeof e||null===e,isPrimitive:e=>o.isStatic(e)||"symbol"===typeof e,isObject:e=>{let t=typeof e;return null!=e&&("object"==t||"function"==t)},isObjectLike:e=>null!=e&&"object"==typeof e,isFunction:e=>"[object Function]"===Object.prototype.toString.call(e),getRawType:e=>Object.prototype.toString.call(e).slice(8,-1),isPlainObject:e=>"[object Object]"===Object.prototype.toString.call(e),isArray:e=>"[object Array]"===Object.prototype.toString.call(e),isRegExp:e=>"[object RegExp]"===Object.prototype.toString.call(e),isDate:e=>"[object Date]"===Object.prototype.toString.call(e),isNative:e=>"function"===typeof e&&/native code/.test(e.toString()),isLength:e=>"number"==typeof e&&e>-1&&e%1==0&&e<=Number.MAX_SAFE_INTEGER,isArrayLike:e=>null!=e&&o.isLength(e.length)&&!o.isFunction(e),isEmpty:function(e){if(null==e)return!0;if(o.isArrayLike(e))return!e.length;if(o.isPlainObject(e)){for(let t in e)if(o.hasOwnProperty.call(e,t))return!1;return!0}return!1},cached:e=>{let t=Object.create(null);return function(a){let l=t[a];return l||(t[a]=e(a))}},camelize:e=>{let t=/-(\w)/g;return e.replace(t,(function(e,t){return t?t.toUpperCase():""}))},hyphenate:e=>{let t=/\B([A-Z])/g;return e.replace(t,"-$1").toLowerCase()},capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1),extend:(e,t)=>{for(let a in t)e[a]=t[a];return e},getExplorerInfo:()=>{let e=navigator.userAgent.toLowerCase();return 0<=e.indexOf("msie")?{type:"IE",version:Number(e.match(/msie ([\d]+)/)[1])}:e.match(/trident\/.+?rv:(([\d.]+))/)?{type:"IE",version:11}:0<=e.indexOf("edge")?{type:"Edge",version:Number(e.match(/edge\/([\d]+)/)[1])}:0<=e.indexOf("firefox")?{type:"Firefox",version:Number(e.match(/firefox\/([\d]+)/)[1])}:0<=e.indexOf("chrome")?{type:"Chrome",version:Number(e.match(/chrome\/([\d]+)/)[1])}:0<=e.indexOf("opera")?{type:"Opera",version:Number(e.match(/opera.([\d]+)/)[1])}:0<=e.indexOf("Safari")?{type:"Safari",version:Number(e.match(/version\/([\d]+)/)[1])}:{type:e,version:-1}},isPCBroswer:()=>{let e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),a="iphone"==e.match(/iphone/i),l="midp"==e.match(/midp/i),r="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),o="ucweb"==e.match(/ucweb/i),i="android"==e.match(/android/i),n="windows ce"==e.match(/windows ce/i),s="windows mobile"==e.match(/windows mobile/i);return!(t||a||l||r||o||i||n||s)},getUrlParam:()=>{let e=document.location.toString(),t=e.split("?"),a=Object.create(null);return t.length>1&&(t=t[1].split("&"),t.forEach((e=>{e=e.split("="),a[e[0]]=e[1]}))),a},toFullScreen:()=>{let e=document.body;e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.requestFullScreen?e.requestFullScreen():alert("浏览器不支持全屏")},exitFullscreen:()=>{let e=parent.document;e.webkitCancelFullScreen?e.webkitCancelFullScreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.cancelFullScreen?e.cancelFullScreen():e.msExitFullscreen?e.msExitFullscreen():e.exitFullscreen?e.exitFullscreen():alert("切换失败,可尝试Esc退出")},adaptiveUnit:e=>{let t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(!t)return;let a=t/1920*100;return e*a}};var i=o,n={name:"PageTable",props:{headerCellStyle:{type:Object,default:()=>({background:"#fafafa",color:"#606266"})},reserveSelection:{type:Boolean,default:!1},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1},pageSize:{type:Number,default:5},pageSizes:{type:Array,default:()=>[5,10,20,30]},treeProps:{type:Object},rowKey:{type:String,default:"id"},defaultExpandAll:{type:Boolean,default:!1}},data(){return{loading:!0,tableData:[],total:0,page:{pageSize:5,pageNum:1},sort:{sort:"create_time",order:"DESC"},current:1}},mounted(){this.page.pageSize=this.pageSize,this.loadTableData()},watch:{tableData(){this.loading=!1},pageSize(){this.page.pageSize=this.pageSize}},methods:{handleSizeChange(e){this.page.pageSize=e,this.loadTableData()},handleCurrentChange(e){this.page.pageNum=e,this.current=e,this.loadTableData()},handleSelectionChange(e){this.$emit("selection-change",e)},handleRowClick(e,t,a){this.$emit("row-click",e,t,a)},handleSortChange(e){const t=e.prop,a="ascending"==e.order?"ASC":"descending"==e.order?"DESC":e.order;this.sort=t?{sort:t,order:a}:{sort:"create_time",order:"DESC"},this.loadTableData()},refresh(){this.page.pageNum=1,this.$emit("refresh",(()=>{this.loadTableData()}))},loadTableData(e,t){i.isEmpty(e)||"reload"!=e||(this.page.pageNum=1,this.current=1),this.loading=!0,this.$emit("load-table-data",{...this.page,...t,...this.sort},(e=>{this.loading=!1,this.tableData=e?e.data:[],this.total=e?e.total:0}))}}},s=n,c=a(1001),d=(0,c.Z)(s,l,r,!1,null,null,null),u=d.exports}}]);
//# sourceMappingURL=281.7a893fb0.js.map