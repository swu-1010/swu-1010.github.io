{"version":3,"file":"js/111.e12ff2d3.js","mappings":"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","sources":["webpack://bookstore_app/./src/components/mobile/Order.vue","webpack://bookstore_app/src/components/mobile/Order.vue","webpack://bookstore_app/./src/components/mobile/Order.vue?4b80","webpack://bookstore_app/./src/components/mobile/Order.vue?6cec"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"order\"},[_c('van-nav-bar',{attrs:{\"left-arrow\":\"\"},on:{\"click-left\":function($event){return _vm.back()}}},[_c('van-search',{attrs:{\"slot\":\"title\",\"placeholder\":\"请输入搜索关键词\"},slot:\"title\",model:{value:(_vm.searchValue),callback:function ($$v) {_vm.searchValue=$$v},expression:\"searchValue\"}}),_c('van-icon',{attrs:{\"slot\":\"right\",\"name\":\"filter-o\"},slot:\"right\"}),_c('span',{staticStyle:{\"margin-right\":\"10px\"},attrs:{\"slot\":\"right\"},slot:\"right\"},[_vm._v(\"筛选\")]),_c('van-icon',{attrs:{\"slot\":\"right\",\"name\":\"ellipsis\"},slot:\"right\"})],1),_c('van-tabs',{attrs:{\"active\":_vm.active,\"animated\":\"\"},on:{\"click\":_vm.change}},_vm._l((6),function(index){return _c('van-tab',{key:index,attrs:{\"name\":index,\"title\":_vm.orderTitle(index)}},_vm._l((_vm.orders),function(publisher,indexP){return _c('div',{key:indexP,staticStyle:{\"text-align\":\"left\"}},[(publisher.books[0].status == _vm.active-1 || _vm.active == 1 || publisher.books[0].status == -1)?_c('div',{staticClass:\"publish\"},[_c('div',{staticStyle:{\"float\":\"left\"}},[_vm._v(_vm._s(publisher.publisher))])]):_vm._e(),_vm._l((publisher.books),function(book,indexB){return _c('div',{key:indexB},[((book.status == _vm.active-1 || _vm.active == 1 || book.status == -1))?_c('div',[_c('van-card',{attrs:{\"num\":book.num,\"price\":book.price,\"desc\":book.author,\"title\":book.name,\"thumb\":'/' + book.img},on:{\"click\":function($event){return _vm.toDetail(book)}},scopedSlots:_vm._u([{key:\"tag\",fn:function(){return [_c('div',{staticClass:\"orderNo\"},[_vm._v(\" \"+_vm._s('订单编号:' + book.etc.no))]),_c('div',{staticClass:\"orderstatus\"},[_vm._v(_vm._s(_vm.orderStatus(book)))])]},proxy:true},{key:\"footer\",fn:function(){return [(book.status == 2)?_c('van-button',{attrs:{\"round\":\"\",\"type\":\"info\"},on:{\"click\":function($event){return _vm.cancelOrder(book.orderId, index)}}},[_vm._v(\"取消订单\")]):_vm._e(),(book.status == -2 || book.status == 5)?_c('van-button',{attrs:{\"round\":\"\",\"type\":\"info\"},on:{\"click\":function($event){return _vm.deleteOrderDetail(book)}}},[_vm._v(\"删除订单\")]):_vm._e(),(book.status != -2 && book.status != 5)?_c('van-button',{attrs:{\"round\":\"\",\"type\":\"info\"},on:{\"click\":function($event){return _vm.action(book, book.status)}}},[_vm._v(_vm._s(_vm.userAction(book.status))+\" \")]):_vm._e()]},proxy:true}],null,true)}),(book.status == 1)?_c('van-count-down',{attrs:{\"time\":_vm.time(book)},on:{\"finish\":function($event){return _vm.finish(book)}},scopedSlots:_vm._u([{key:\"default\",fn:function(timeData){return [_c('span',[_vm._v(\"剩余时间 \")]),_c('span',{staticClass:\"block\"},[_vm._v(_vm._s(timeData.hours))]),_c('span',{staticClass:\"colon\"},[_vm._v(\":\")]),_c('span',{staticClass:\"block\"},[_vm._v(_vm._s(timeData.minutes))]),_c('span',{staticClass:\"colon\"},[_vm._v(\":\")]),_c('span',{staticClass:\"block\"},[_vm._v(_vm._s(timeData.seconds))])]}}],null,true)}):_vm._e()],1):_vm._e()])})],2)}),0)}),1),_c('van-action-sheet',{attrs:{\"close-on-click-action\":\"\"},model:{value:(_vm.show),callback:function ($$v) {_vm.show=$$v},expression:\"show\"}},[_c('template',{slot:\"default\"},[_c('div',{staticStyle:{\"padding\":\"10px\"}},[_c('van-field',{staticStyle:{\"border-radius\":\"16px\"},attrs:{\"rows\":\"4\",\"autosize\":\"\",\"label\":\"取消理由\",\"type\":\"textarea\",\"maxlength\":\"60\",\"placeholder\":\"请输入理由\",\"show-word-limit\":\"\"},model:{value:(_vm.reason),callback:function ($$v) {_vm.reason=$$v},expression:\"reason\"}}),_c('van-button',{staticStyle:{\"float\":\"right\",\"margin-bottom\":\"10px\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.cancel()}}},[_vm._v(\"提交\")])],1)])],2)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"order\">\r\n        <van-nav-bar left-arrow @click-left=back()>\r\n            <van-search v-model=\"searchValue\" placeholder=\"请输入搜索关键词\" slot=\"title\" />\r\n            <van-icon name=\"filter-o\" slot=\"right\" />\r\n            <span style=\"margin-right: 10px;\" slot=\"right\">筛选</span>\r\n            <van-icon name=\"ellipsis\" slot=\"right\" />\r\n        </van-nav-bar>\r\n        <van-tabs :active=\"active\" @click=\"change\" animated>\r\n            <van-tab v-for=\"index in 6\" :key=\"index\" :name=\"index\" :title=\"orderTitle(index)\">\r\n                <div v-for=\"publisher, indexP in orders\" :key=\"indexP\" style=\"text-align: left;\">\r\n                    <div class=\"publish\" v-if=\"publisher.books[0].status == active-1 || active == 1 || publisher.books[0].status == -1\">\r\n                        <div style=\"float:left\">{{ publisher.publisher }}</div>\r\n                    </div>\r\n                    <div v-for=\"book, indexB in publisher.books\" :key=\"indexB\">\r\n                        <!-- {{indexB}} -->\r\n                        <div v-if=\"(book.status == active-1 || active == 1 || book.status == -1)\">\r\n                            <van-card :num=\"book.num\" :price=\"book.price\" :desc=\"book.author\"\r\n                                :title=\"book.name\" :thumb=\"'/' + book.img\" @click=\"toDetail(book)\">\r\n                                <template #tag>\r\n                                    <div class=\"orderNo\">\r\n                                        {{ '订单编号:' + book.etc.no }}</div>\r\n                                    <div class=\"orderstatus\">{{ orderStatus(book) }}</div>\r\n                                </template>\r\n                                <template #footer>\r\n                                    <van-button v-if=\"book.status == 2\" @click=\"cancelOrder(book.orderId, index)\" round type=\"info\">取消订单</van-button>\r\n                                    <van-button v-if=\"book.status == -2 || book.status == 5\" @click=\"deleteOrderDetail(book)\" round type=\"info\">删除订单</van-button>\r\n                                    <van-button v-if=\"book.status != -2 && book.status != 5\" round type=\"info\"\r\n                                        @click=\"action(book, book.status)\">{{ userAction(book.status) }}\r\n                                    </van-button>\r\n                                </template> \r\n                            </van-card>\r\n                            <van-count-down v-if=\"book.status == 1\" :time=\"time(book)\" @finish=\"finish(book)\">\r\n                                <template #default=\"timeData\">\r\n                                    <span>剩余时间 </span>\r\n                                    <span class=\"block\">{{ timeData.hours }}</span>\r\n                                    <span class=\"colon\">:</span>\r\n                                    <span class=\"block\">{{ timeData.minutes }}</span>\r\n                                    <span class=\"colon\">:</span>\r\n                                    <span class=\"block\">{{ timeData.seconds }}</span>\r\n                                </template>\r\n                            </van-count-down>\r\n                            <!-- <van-count-down ref=\"countDown\" millisecond :time=\"3000\" :auto-start=\"true\" format=\"ss:SSS\"  /> -->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </van-tab>\r\n        </van-tabs>\r\n        <van-action-sheet v-model=\"show\" close-on-click-action>\r\n            <template slot=\"default\">\r\n                <div style=\"padding:10px\">\r\n                    <van-field style=\"border-radius: 16px;\" v-model=\"reason\" rows=\"4\" autosize label=\"取消理由\" type=\"textarea\" maxlength=\"60\"\r\n                    placeholder=\"请输入理由\" show-word-limit />\r\n                    <van-button style=\"float:right;margin-bottom: 10px;\" @click=\"cancel()\" type=\"primary\">提交</van-button>\r\n                </div>\r\n            </template>\r\n        </van-action-sheet>\r\n        <!-- <van-loading type=\"spinner\" color=\"#1989fa\" /> -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport api from '@/api';\r\nimport { Toast } from 'vant';\r\nexport default {\r\n    name: 'order',\r\n    inject: ['reload'],\r\n    data: function () {\r\n        return {\r\n            active: 0,\r\n            searchValue: '',\r\n            orders: [],\r\n            load: false,\r\n            reason: '',\r\n            show: false,\r\n            i: '',\r\n            orderId: '',\r\n        }\r\n    },\r\n    created: function () {\r\n        console.log(this.$route.query.status);\r\n        let status = parseInt(this.$route.query.status)+1;\r\n        // console.log(status);\r\n        this.getOrder(status);\r\n        this.active = status;\r\n    },\r\n    methods: {\r\n        orderTitle(index) {\r\n            let title = ['全部', '待付款', '待发货', '待收货', '待评价', '已评价'];\r\n            return title[index - 1];\r\n        },\r\n        orderStatus(book) {\r\n            let title = ['等待买家付款', '买家已付款', '卖家已发货', '交易成功', '退款/售后'];\r\n            if (book.status == -1)\r\n                return '已评价'\r\n            else if (book.status == -2) {\r\n                if (book.etc.cancelReason == \"超时自动取消\")\r\n                    return '超时取消'\r\n                else\r\n                    return '交易关闭'\r\n            }               \r\n            else\r\n                return title[book.status-1];\r\n        },\r\n        userAction(index) {\r\n            let title = ['继续付款', '催发货', '确认收货', '评价'];\r\n            if (index == -1)\r\n                return \"追评\"\r\n            else\r\n                return title[index -1];\r\n        },\r\n        finish(book) {\r\n            Toast(\"订单\"+book.etc.no+\"超时自动取消\")\r\n            this.getOrder(1)\r\n            this.reload()\r\n        },\r\n        back() {\r\n            this.$router.push({path: '/frontUser'});\r\n        },\r\n        change(index) {\r\n            // \r\n            \r\n            this.getOrder(index);\r\n            this.$router.push({ path: '/order', query: { status: index == 6 ? -1 : index - 1 } });\r\n        },\r\n        time(book) {\r\n            console.log(book.etc.cancelTime, \"取消时间\")\r\n            // console.log(Date.now());\r\n            return book.etc.cancelTime - Date.now()\r\n        },\r\n        cancelOrder(orderId, index) {\r\n            event.stopPropagation();\r\n            this.show = true\r\n            this.orderId = orderId\r\n            this.i = index\r\n            console.log(index)\r\n        },\r\n        cancel() {\r\n            //cancelType--1 用户取消\r\n            //cancelType--2 超时取消\r\n            // if (cancelType == 2)\r\n            //     this.reason = \"超时自动取消\"\r\n            let self = this;\r\n            api.cancelOrder(\"/order/cancel\", this.orderId, this.reason)\r\n                .then(res => {\r\n                    console.log(res)\r\n                    Toast(\"取消成功\")\r\n                    \r\n                    self.show = false\r\n                    self.getOrder(self.i-1)\r\n                })\r\n        },\r\n        deleteOrderDetail(book) {\r\n            event.stopPropagation()\r\n            // console.log(\"book\", book);\r\n            let self = this\r\n            this.$dialog.confirm({\r\n                title: \"删除订单\",\r\n                message: '是否继续？',\r\n            })\r\n                .then(() => {\r\n                    api.deleteOrderDetail(\"/orderDetail/deleteByIds\", book.orderId, book.bookId)\r\n                        .then(res => {\r\n                            console.log(\"删除订单\", res.data);\r\n                            Toast(\"删除成功\")\r\n                            self.getOrder(1)\r\n                        })\r\n                })\r\n                .catch(() => {\r\n                    // on cancel\r\n                });\r\n        },\r\n        action(book, status) {\r\n            event.stopPropagation();\r\n            // this.load = true;\r\n            // setTimeout(function () {\r\n            //     this.load = false;\r\n            // }, 1000)\r\n            console.log(status);\r\n            if (status != 2) {\r\n                let self = this;\r\n                this.$dialog.confirm({\r\n                    title: this.userAction(status),\r\n                    message: '是否继续？',\r\n                })\r\n                    .then(() => {\r\n                        // on confirm\r\n                        if (status == 4 || status == -1) {//评价、追评\r\n                            self.$router.push({ path: '/comment', query: { book: book } });\r\n                        }\r\n                        else {\r\n                            api.updateOrderDetail(\"/orderDetail/update\", book.orderId, book.bookId, book.status)\r\n                                .then(res => {\r\n                                    console.log(res);\r\n                                    self.getOrder(status);\r\n                                    self.reload()\r\n                                })\r\n                        }\r\n                    })\r\n                    .catch(() => {\r\n                        // on cancel\r\n                    });\r\n            } \r\n        },\r\n        toDetail(book) {\r\n            if (book.status == 5)\r\n                this.$router.push({ path: '/reFund', query: { books: book } });\r\n            else\r\n                this.$router.push({ path: '/orderDetail', query: { book: book } });\r\n        },\r\n        getOrders(orders) {//按照出版社分类\r\n            let publisher = [];\r\n            orders.forEach(i => {\r\n                publisher.push(i.publisher);\r\n            })\r\n            // console.log(publisher);\r\n            //去重出版社\r\n            publisher = Array.from(new Set(publisher));\r\n            // console.log(publisher);\r\n\r\n            //不同出版社\r\n            let list = [];\r\n            for (let i = 0; i < publisher.length; i++) {\r\n                list.push({ publisher: publisher[i], books: [] });\r\n                let item = [];\r\n                orders.forEach(book => {\r\n                    if (book.publisher == publisher[i])\r\n                        item.push(book);\r\n                })\r\n                // console.log(item);\r\n\r\n                list[i].books = item;\r\n            }\r\n            return list;\r\n        },\r\n        getOrder(index) {          \r\n            this.active = index;\r\n            if (index == 6)\r\n                index = 0\r\n            let status = index - 1;\r\n            // console.log(status);\r\n            let self = this;\r\n            api.getUser(\"/user/getUser\", localStorage.getItem('username'))\r\n                .then(function (res1) {\r\n                    // console.log(res1.statusCode);\r\n                    if (res1.statusCode == 200) {\r\n                        api.getByUserId(\"/order/getByUserId\")\r\n                            .then(res => {\r\n                                console.log(res.data);\r\n                                let orderIds = [];\r\n                                res.data.forEach(i => {\r\n                                    orderIds.push(i.id);\r\n                                })\r\n                                console.log(orderIds);\r\n                                api.getDetail(\"/orderDetail/getDetail\", orderIds.join(\",\"), status)\r\n                                    .then(res1 => {\r\n                                        if (res1.statusCode == 200) {\r\n                                        console.log(res1.data);\r\n                                        \r\n                                        let books = [];\r\n                                        let carts = [];\r\n                                        carts = res1.data;\r\n\r\n                                        let bookIds = [];\r\n                                        carts.forEach(i => {\r\n                                            bookIds.push(i.bookId);\r\n\r\n                                        })\r\n                                        // console.log(bookIds.join(\",\"));\r\n                                        api.getCartBookByIds(\"/book/getBookByIds\", bookIds.join(\",\"))\r\n                                            .then(function (res2) {\r\n                                                //合并数组\r\n                                                console.log(res2.data);\r\n                                                books = carts.map((item, index) => {\r\n                                                    return { ...res2.data[index], ...item };\r\n                                                });\r\n                                                console.log(books);\r\n                                                self.orders = self.getOrders(books);\r\n                                                console.log(self.orders);\r\n                                            })\r\n                                        }\r\n                                    })\r\n                            })\r\n                    }\r\n                    else if (res1.statusCode == 401) {\r\n                        Toast(\"token过期\");\r\n                        self.$router.push('login');\r\n                    }\r\n                })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.publish {\r\n    margin-left: 5px;\r\n    padding: 15px;\r\n    line-height: 15px;\r\n    margin-bottom: 15px;\r\n}\r\n\r\n.van-card__tag {\r\n    left: 290px;\r\n    width: 85px;\r\n    top: 0px;\r\n}\r\n\r\n.van-card__title {\r\n    white-space: normal;\r\n    word-break: break-all;\r\n    word-wrap: break-word;\r\n    width: 180px;\r\n}\r\n\r\n.van-card {\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.van-button--info {\r\n    color: #000;\r\n    background-color: #ffffff;\r\n    border: 1px solid #a6adb5;\r\n}\r\n\r\n.van-loading {\r\n    position: absolute;\r\n    left: 175px;\r\n    background-color: white;\r\n}\r\n.orderNo {\r\n    position: relative;\r\n    bottom: 20px;\r\n    right: 290px;\r\n    width: 285px;\r\n}\r\n.orderstatus {\r\n    color: #30cbce;\r\n    font-size: medium;\r\n    top: 10px;\r\n    right: 20px;\r\n    position: relative;\r\n}\r\n.van-count-down {\r\n    position: relative;\r\n    bottom: 20px;\r\n    left: 20px;\r\n}\r\n.colon {\r\n    display: inline-block;\r\n    margin: 0 4px;\r\n    color: #ee0a24;\r\n  }\r\n  .block {\r\n    display: inline-block;\r\n    width: 22px;\r\n    color: #fff;\r\n    font-size: 12px;\r\n    text-align: center;\r\n    background-color: #ee0a24;\r\n  }\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Order.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Order.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Order.vue?vue&type=template&id=722907a7&scoped=true&\"\nimport script from \"./Order.vue?vue&type=script&lang=js&\"\nexport * from \"./Order.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Order.vue?vue&type=style&index=0&id=722907a7&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"722907a7\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","$event","back","slot","model","value","searchValue","callback","$$v","expression","staticStyle","_v","active","change","_l","index","key","orderTitle","orders","publisher","indexP","books","status","_s","_e","book","indexB","num","price","author","name","img","toDetail","scopedSlots","_u","fn","etc","no","orderStatus","proxy","cancelOrder","orderId","deleteOrderDetail","action","userAction","time","finish","timeData","hours","minutes","seconds","show","reason","cancel","staticRenderFns","inject","data","load","i","created","console","methods","path","query","event","api","then","self","title","message","catch","getOrders","list","item","getOrder","res","orderIds","carts","bookIds","component"],"sourceRoot":""}