{"version":3,"file":"js/701.8988d1bd.js","mappings":"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","sources":["webpack://bookstore_app/./src/components/mobile/Favor.vue","webpack://bookstore_app/src/components/mobile/Favor.vue","webpack://bookstore_app/./src/components/mobile/Favor.vue?c377","webpack://bookstore_app/./src/components/mobile/Favor.vue?3e3d"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"favor\"},[_c('van-nav-bar',{attrs:{\"left-arrow\":\"\",\"title\":'我的收藏'+_vm.favorNum},on:{\"click-left\":function($event){return _vm.$router.back(-1)}}},[_c('van-icon',{staticStyle:{\"margin-right\":\"10px\"},attrs:{\"slot\":\"right\",\"name\":\"search\"},slot:\"right\"}),_c('span',{staticStyle:{\"margin-right\":\"10px\"},attrs:{\"slot\":\"right\"},slot:\"right\"},[_vm._v(\"管理\")])],1),(this.$store.getters.getFavorNum == '')?_c('van-notice-bar',[_vm._v(\"您的收藏空空如也...\")]):_vm._e(),_c('div',{staticClass:\"content\"},[_vm._l((_vm.books),function(book,index){return _c('van-card',{key:index,attrs:{\"price\":book.etc.book.price,\"desc\":book.etc.book.author,\"title\":book.etc.book.name,\"thumb\":'/' + book.etc.book.img},on:{\"click\":function($event){return _vm.toDetail(book.bookId)}},scopedSlots:_vm._u([{key:\"tags\",fn:function(){return [_c('van-tag',{attrs:{\"plain\":\"\",\"size\":\"large\",\"type\":\"primary\"}},[_vm._v(_vm._s(book.etc.book.publisher))]),_c('br'),_c('van-tag',{attrs:{\"type\":\"danger\"}},[_vm._v(_vm._s(book.etc.cateName))])]},proxy:true},{key:\"tag\",fn:function(){return [_c('van-checkbox',{nativeOn:{\"click\":function($event){return _vm.updateFavor(index, 0)}},model:{value:(_vm.checkedIds[index]),callback:function ($$v) {_vm.$set(_vm.checkedIds, index, $$v)},expression:\"checkedIds[index]\"}})]},proxy:true},{key:\"num\",fn:function(){return [_c('van-icon',{attrs:{\"name\":\"delete-o\"},on:{\"click\":function($event){return _vm.deleteFavor(book.bookId)}}})]},proxy:true}],null,true)})}),_c('van-submit-bar',{attrs:{\"button-text\":\"删除\"},on:{\"submit\":function($event){return _vm.deleteFavors()}}},[_c('van-checkbox',{staticStyle:{\"width\":\"70%\"},nativeOn:{\"click\":function($event){return _vm.updateFavor(0, 1)}},model:{value:(_vm.allCheck),callback:function ($$v) {_vm.allCheck=$$v},expression:\"allCheck\"}},[_vm._v(\"全选\")])],1)],2)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"favor\">\r\n        <van-nav-bar left-arrow @click-left=$router.back(-1) :title=\"'我的收藏'+favorNum\">\r\n            <!-- <van-search v-model=\"searchValue\" placeholder=\"请输入搜索关键词\" slot=\"title\" /> -->\r\n            <van-icon style=\"margin-right: 10px;\" name=\"search\" slot=\"right\" />\r\n            <span style=\"margin-right: 10px;\" slot=\"right\">管理</span>\r\n        </van-nav-bar>\r\n        <van-notice-bar v-if=\"this.$store.getters.getFavorNum == ''\">您的收藏空空如也...</van-notice-bar>\r\n        <div class=\"content\">\r\n            <van-card v-for=\"book, index in books\" :key=\"index\" :price=\"book.etc.book.price\" :desc=\"book.etc.book.author\"\r\n                :title=\"book.etc.book.name\" :thumb=\"'/' + book.etc.book.img\" @click=\"toDetail(book.bookId)\">\r\n                <template #tags>\r\n                    <van-tag plain size=\"large\" type=\"primary\">{{ book.etc.book.publisher }}</van-tag>\r\n                    <br>\r\n                    <van-tag type=\"danger\">{{ book.etc.cateName }}</van-tag>\r\n                </template>\r\n                <template #tag>\r\n                    <van-checkbox v-model=\"checkedIds[index]\" @click.native=\"updateFavor(index, 0)\" />\r\n                </template>\r\n                <template #num>\r\n                    <van-icon name=\"delete-o\" @click=\"deleteFavor(book.bookId)\" />\r\n                </template>\r\n            </van-card>\r\n            <van-submit-bar button-text=\"删除\" @submit=\"deleteFavors()\">\r\n                <van-checkbox style=\"width: 70%;\" v-model=\"allCheck\" @click.native=\"updateFavor(0, 1)\">全选</van-checkbox>\r\n            </van-submit-bar>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '@/api'\r\n\r\nexport default {\r\n    name: 'favor',\r\n    data: function () {\r\n        return {\r\n            searchValue: '',\r\n            books: [],\r\n            ids: [],\r\n            allCheck: '',\r\n            checkedIds: [],\r\n            no: 0\r\n        }\r\n    },\r\n    methods: {\r\n        checkAll() {\r\n            let flag = 0;\r\n            for (let i = 0; i < this.checkedIds.length; i++) {\r\n                if (this.checkedIds[i] == false) {\r\n                    this.allCheck = false;\r\n                    break;\r\n                }\r\n                else\r\n                    flag++;\r\n                if (flag == this.books.length)\r\n                    this.allCheck = true;\r\n            }\r\n        },\r\n        updateFavor(index, flag) {\r\n            event.stopPropagation();\r\n            if (this.no == 0) {\r\n                for (let i = 0; i < this.books.length; i++)\r\n                    this.checkedIds[i] = false;\r\n                this.no++;\r\n            }\r\n            if (flag == 0) {\r\n                this.checkedIds[index] = !this.checkedIds[index];\r\n            }\r\n            else if (flag == 1) {\r\n                let cnt = 0;\r\n                for (let i = 0; i < this.books.length; i++) {\r\n                    if (this.checkedIds[i] == true)\r\n                        cnt++;\r\n                }\r\n                if (cnt == this.books.length) {//全反选\r\n                    for (let i = 0; i < this.books.length; i++)\r\n                        this.checkedIds[i] = false;\r\n                }\r\n                else {//全选\r\n                    for (let i = 0; i < this.books.length; i++)\r\n                        if (this.checkedIds[i] == false)\r\n                            this.checkedIds[i] = true;\r\n                }\r\n            }\r\n            this.checkAll();\r\n        },\r\n        toDetail(id) {\r\n            this.$router.push({ name: 'detail', query: { id: id } });\r\n        },\r\n        deleteFavor(ids) {//删除\r\n            let self = this;\r\n            event.stopPropagation();\r\n            this.$dialog.confirm({\r\n                title: '删除商品',\r\n                message: '确认删除吗？',\r\n            })\r\n                .then(() => {\r\n                    // on confirm\r\n                    console.log(\"delete\");\r\n                    api.deleteByIds(\"/favor/deleteByIds\", ids)\r\n                        .then(function (res) {\r\n                            // console.log(res.data);\r\n                            self.getFavor();\r\n                        })\r\n                    \r\n                    // self.reload();\r\n                })\r\n                .catch(() => {\r\n                    // on cancel\r\n\r\n                });\r\n        },\r\n        deleteFavors() {\r\n            let ids = [];\r\n            for (let i = 0; i < this.books.length; i++)\r\n                if (this.checkedIds[i] == true)\r\n                    ids.push(this.books[i].bookId);\r\n            console.log(ids, \"ids\");\r\n            if (ids.length != 0)\r\n                this.deleteFavor(ids.join(\",\"));  \r\n        },\r\n        getFavor() {\r\n            let self = this;\r\n            api.getUser(\"/user/getUser\", localStorage.getItem('username'))\r\n                .then(function (res1) {\r\n                    // console.log(res1.statusCode);\r\n                    if (res1.statusCode == 200) {\r\n                        api.getBooksByUserId(\"/favor/getByUserId\", res1.data.user.id)\r\n                            .then(function (res2) {\r\n                                // self.books = [];\r\n                                // self.favors = [];\r\n                                self.books = res2.data;\r\n                                self.$store.dispatch('setFavorNum');\r\n                                self.checkAll();\r\n                            })\r\n                    }\r\n                    else if (res1.statusCode == 401) {\r\n                        Toast(\"token过期\");\r\n                        self.$router.push('login');\r\n                    }\r\n                })\r\n        }\r\n    },\r\n    created: function () {\r\n        this.getFavor();\r\n        this.checkedIds.fill(false);\r\n        this.checkAll();\r\n    },\r\n    computed: {\r\n        favorNum: function () {\r\n            let n = this.$store.getters.getFavorNum;\r\n            return n > 0 ? \"(\" + n + \")\" : '';\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.favor {\r\n    padding: 10px;\r\n}\r\n\r\n.content {\r\n    text-align: left;\r\n}\r\n\r\n.van-submit-bar {\r\n    bottom: 50px;\r\n}\r\n\r\n.van-card__tag {\r\n    top: 30px;\r\n    left: -20px;\r\n}\r\n\r\n.van-card__num {\r\n    position: relative;\r\n    bottom: 40px;\r\n    left: 10px;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Favor.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Favor.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Favor.vue?vue&type=template&id=bb4aa4c8&scoped=true\"\nimport script from \"./Favor.vue?vue&type=script&lang=js\"\nexport * from \"./Favor.vue?vue&type=script&lang=js\"\nimport style0 from \"./Favor.vue?vue&type=style&index=0&id=bb4aa4c8&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bb4aa4c8\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","favorNum","on","$event","$router","back","staticStyle","slot","_v","$store","getters","getFavorNum","_e","_l","books","book","index","key","etc","price","author","name","img","toDetail","bookId","scopedSlots","_u","fn","_s","publisher","cateName","proxy","nativeOn","updateFavor","model","value","checkedIds","callback","$$v","$set","expression","deleteFavor","deleteFavors","allCheck","staticRenderFns","data","searchValue","ids","no","methods","checkAll","flag","i","length","event","stopPropagation","cnt","id","push","query","self","$dialog","confirm","title","message","then","console","log","api","deleteByIds","res","getFavor","catch","join","getUser","localStorage","getItem","res1","statusCode","getBooksByUserId","user","res2","dispatch","Toast","created","fill","computed","n","component"],"sourceRoot":""}