"use strict";(self["webpackChunkbookstore_app"]=self["webpackChunkbookstore_app"]||[]).push([[889],{30889:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"manageBook"},[t("div",{staticStyle:{"margin-bottom":"20px"}},[t("el-row",{staticStyle:{"padding-left":"30px"},attrs:{justify:"space-between"}},[t("el-col",{attrs:{span:6}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.change},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.option,(function(e,a){return t("el-option",{key:a,attrs:{label:e.text,value:e.value}})})),1)],1),t("el-col",{attrs:{span:6}},[t("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}})],1),t("el-col",{attrs:{span:6}},[t("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.search}},[e._v("搜索")])],1),t("el-col",{attrs:{span:6}},[t("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),t("el-button",{attrs:{type:"primary"},on:{click:e.delAll}},[e._v("批量删除")])],1)],1)],1),t("pageTable",{ref:"dataTable",attrs:{"row-key":"id"},on:{"load-table-data":e.loadTableData,"selection-change":e.selectionChange}},[t("template",{slot:"tb-columns"},[t("el-table-column",{attrs:{prop:"name",label:"名称",align:"center",width:"150","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"img",label:"图片",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("img",{attrs:{src:e.row.img,"min-width":"70",height:"70"}})]}}])}),t("el-table-column",{attrs:{prop:"author",label:"作者","show-overflow-tooltip":!0,align:"center",width:"100"}}),t("el-table-column",{attrs:{prop:"category",filters:e.categorys,"filter-method":e.filterCategory,label:"类别",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.etc.cateName)+" ")]}}])}),t("el-table-column",{attrs:{prop:"publisher",label:"出版社",align:"center",width:"110","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"price",label:"价格",align:"center",width:"80"}}),t("el-table-column",{attrs:{prop:"description",label:"简介",align:"center","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.edit(a.row)}}},[e._v("编辑")]),e._v(" ｜ "),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.delOne(a.row.id)}}},[e._v("删除")])]}}])})],1)],2),e.visible?t("Edit",{attrs:{title:e.title,visible:e.visible,defaultFormData:e.defaultFormData},on:{close:e.close}}):e._e()],1)},o=[],r=(a(16743),a(88848)),i=(a(57658),a(7877)),s=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,visible:e.visible,"before-close":e.close}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"图片",required:!0}},[t("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"","list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-change":e.UploadImage,"before-upload":e.beforeUpload,limit:1,"file-list":e.fileList,"auto-upload":!1}},[e.form.img?t("img",{staticClass:"img",attrs:{src:e.form.img}}):t("div",{staticStyle:{width:"50px"}},[t("i",{staticClass:"el-icon-plus"})])])],1),t("el-form-item",{attrs:{label:"作者",prop:"valuauthore"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.author,callback:function(t){e.$set(e.form,"author",t)},expression:"form.author"}})],1),t("el-form-item",{attrs:{label:"类别",prop:"category"}},[t("template",{slot:"default"},[t("el-select",{staticStyle:{float:"left"},attrs:{placeholder:"请选择",clearable:""},on:{change:e.change},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.cate,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.id}})})),1)],1)],2),t("el-form-item",{attrs:{label:"出版社",prop:"publisher"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.publisher,callback:function(t){e.$set(e.form,"publisher",t)},expression:"form.publisher"}})],1),t("el-form-item",{attrs:{label:"价格",prop:"price"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),t("el-form-item",{staticStyle:{"white-space":"pre-wrap"},attrs:{label:"简介",prop:"description"}},[t("el-input",{attrs:{type:"textarea",maxlength:500,autosize:{minRows:1,maxRows:5},autocomplete:"off"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.close()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("确 定")])],1)],1)},n=[],c={name:"editBook",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"新增"},defaultFormData:{type:Object}},data(){return{flag:!1,form:{},flag:!1,cate:[],saveOrUpdate:!1,fileList:[],rules:{name:[{required:!0,message:"不能为空"}],value:[{required:!0,message:"不能为空",trigger:"blur"}]}}},mounted(){let e=this;i.Z.getAllCate("/category/getAllCate").then((t=>{e.cate=t.data,"{}"==JSON.stringify(e.defaultFormData)?(e.flag=!1,e.saveOrUpdate=!1):(e.form=JSON.parse(JSON.stringify(e.defaultFormData)),e.flag=!0,e.saveOrUpdate=!0)}))},methods:{change(){console.log(this.form.category)},close(){this.flag=!1,this.$emit("close",this.flag)},UploadImage(e,t){let a=this;console.log(e),i.Z.uploadImg("/book/uploadImg",e.raw).then((e=>{console.log(e),a.form.img=e}))},handleRemove(e,t){console.log(e,t)},handlePictureCardPreview(e){console.log(e.url),this.form.img=e.url},beforeUpload(e){const t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传图片大小不能超过 2MB!"),t&&a},submit(){console.log(this.form);let e=this;this.saveOrUpdate?i.Z.updateBook("/book/update",this.form).then((t=>{console.log(t.data),e.flag=!0,t.message&&t.data?(0,r.Z)(t.message+" "+t.data):t.message?(0,r.Z)(t.message):(0,r.Z)("更新失败"),e.$emit("close",e.flag)})).catch((t=>{console.log(t),e.flag=!1,(0,r.Z)("更新失败"),e.$emit("close",e.flag)})):i.Z.updateBook("/book/save",this.form).then((t=>{console.log(t.data),e.flag=!0,t.message&&t.data?(0,r.Z)(t.message+" "+t.data):t.message?(0,r.Z)(t.message):(0,r.Z)("添加失败"),e.$emit("close",e.flag)})).catch((t=>{console.log(t),e.flag=!1,(0,r.Z)("添加失败"),e.$emit("close",e.flag)}))}}},u=c,d=a(1001),p=(0,d.Z)(u,s,n,!1,null,"1511d43e",null),m=p.exports,h=a(78066),g={name:"manageBook",components:{PageTable:h.Z,Edit:m},data(){return{title:"新增",visible:!1,defaultFormData:{},ids:"",searchKey:"",type:0,option:[{text:"书名",value:1},{text:"作者",value:2},{text:"出版社",value:3}],categorys:[],selected:1}},created(){let e=this;i.Z.getAllCate("/category/getAllCate").then((t=>{let a=[];t.data.forEach((e=>{a.push({text:e.name,value:e.name})})),e.categorys=a,console.log(e.categorys,"类别")}))},methods:{filterCategory(e,t){return t.etc.cateName==e},change(e){console.log(e)},search(){this.$refs.dataTable.loadTableData("reload")},selectionChange(e){var t=[];for(var a of e)t.push(a.id);this.ids=t.join(",")},delAll(){this.ids.length<=0?this.$message({message:"请先选择记录",type:"warning"}):this.del(this.ids)},delOne(e){this.del(e)},del(e){this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{i.Z.deleteByIds("/book/deleteByIds",e).then((e=>{console.log(e),e.message&&e.data?(0,r.Z)(e.message+" "+e.data):e.message?(0,r.Z)(e.message):(0,r.Z)("删除失败"),this.$refs.dataTable.loadTableData("reload",{})})).catch((e=>{console.log(e),(0,r.Z)("删除失败")}))})).catch((()=>{}))},close(e){this.visible=!1,e&&this.$refs.dataTable.loadTableData("reload")},add(){this.visible=!0,this.defaultFormData={}},edit(e){this.visible=!0,this.title="编辑",this.defaultFormData=e},loadTableData(e,t){console.log(e),""!=this.searchKey?i.Z.searchBookByKey("/book/searchBookByKey",e.pageNum,e.pageSize,this.selected,this.searchKey).then((e=>{console.log(e);let a={data:e.data.records,total:e.data.total};t(a)})).catch((e=>{console.log(e)})):i.Z.getBookByCate("/book/getBookByCate",e.pageNum,e.pageSize,0).then((e=>{console.log(e);let a={data:e.data.records,total:e.data.total};t(a)})).catch((e=>{console.log(e)}))}}},f=g,b=(0,d.Z)(f,l,o,!1,null,"cde4112e",null),y=b.exports},78066:function(e,t,a){a.d(t,{Z:function(){return d}});var l=function(){var e=this,t=e._self._c;return t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"filterTable",attrs:{"max-height":"560",border:e.border,stripe:e.stripe,"header-cell-style":e.headerCellStyle,"highlight-current-row":"",data:e.tableData,"element-loading-text":"加载中...","tree-props":e.treeProps,"row-key":e.rowKey,"default-expand-all":e.defaultExpandAll},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick,"sort-change":e.handleSortChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._t("tb-columns")],2),t("el-row",{staticClass:"mt-15"},[t("el-col",{staticClass:"flex justify-end"},[t("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, sizes, jumper",total:e.total,"page-size":e.page.pageSize,"page-sizes":e.pageSizes,"current-page":e.current},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},o=[];const r={objectIndexInArray:(e,t,a)=>{let l=-1;for(let o in e)if(e[o][a]===t[a]){l=o;break}return l},isStatic:e=>"string"===typeof e||"number"===typeof e||"boolean"===typeof e||"undefined"===typeof e||null===e,isPrimitive:e=>r.isStatic(e)||"symbol"===typeof e,isObject:e=>{let t=typeof e;return null!=e&&("object"==t||"function"==t)},isObjectLike:e=>null!=e&&"object"==typeof e,isFunction:e=>"[object Function]"===Object.prototype.toString.call(e),getRawType:e=>Object.prototype.toString.call(e).slice(8,-1),isPlainObject:e=>"[object Object]"===Object.prototype.toString.call(e),isArray:e=>"[object Array]"===Object.prototype.toString.call(e),isRegExp:e=>"[object RegExp]"===Object.prototype.toString.call(e),isDate:e=>"[object Date]"===Object.prototype.toString.call(e),isNative:e=>"function"===typeof e&&/native code/.test(e.toString()),isLength:e=>"number"==typeof e&&e>-1&&e%1==0&&e<=Number.MAX_SAFE_INTEGER,isArrayLike:e=>null!=e&&r.isLength(e.length)&&!r.isFunction(e),isEmpty:function(e){if(null==e)return!0;if(r.isArrayLike(e))return!e.length;if(r.isPlainObject(e)){for(let t in e)if(r.hasOwnProperty.call(e,t))return!1;return!0}return!1},cached:e=>{let t=Object.create(null);return function(a){let l=t[a];return l||(t[a]=e(a))}},camelize:e=>{let t=/-(\w)/g;return e.replace(t,(function(e,t){return t?t.toUpperCase():""}))},hyphenate:e=>{let t=/\B([A-Z])/g;return e.replace(t,"-$1").toLowerCase()},capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1),extend:(e,t)=>{for(let a in t)e[a]=t[a];return e},getExplorerInfo:()=>{let e=navigator.userAgent.toLowerCase();return 0<=e.indexOf("msie")?{type:"IE",version:Number(e.match(/msie ([\d]+)/)[1])}:e.match(/trident\/.+?rv:(([\d.]+))/)?{type:"IE",version:11}:0<=e.indexOf("edge")?{type:"Edge",version:Number(e.match(/edge\/([\d]+)/)[1])}:0<=e.indexOf("firefox")?{type:"Firefox",version:Number(e.match(/firefox\/([\d]+)/)[1])}:0<=e.indexOf("chrome")?{type:"Chrome",version:Number(e.match(/chrome\/([\d]+)/)[1])}:0<=e.indexOf("opera")?{type:"Opera",version:Number(e.match(/opera.([\d]+)/)[1])}:0<=e.indexOf("Safari")?{type:"Safari",version:Number(e.match(/version\/([\d]+)/)[1])}:{type:e,version:-1}},isPCBroswer:()=>{let e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),a="iphone"==e.match(/iphone/i),l="midp"==e.match(/midp/i),o="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),r="ucweb"==e.match(/ucweb/i),i="android"==e.match(/android/i),s="windows ce"==e.match(/windows ce/i),n="windows mobile"==e.match(/windows mobile/i);return!(t||a||l||o||r||i||s||n)},getUrlParam:()=>{let e=document.location.toString(),t=e.split("?"),a=Object.create(null);return t.length>1&&(t=t[1].split("&"),t.forEach((e=>{e=e.split("="),a[e[0]]=e[1]}))),a},toFullScreen:()=>{let e=document.body;e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.requestFullScreen?e.requestFullScreen():alert("浏览器不支持全屏")},exitFullscreen:()=>{let e=parent.document;e.webkitCancelFullScreen?e.webkitCancelFullScreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.cancelFullScreen?e.cancelFullScreen():e.msExitFullscreen?e.msExitFullscreen():e.exitFullscreen?e.exitFullscreen():alert("切换失败,可尝试Esc退出")},adaptiveUnit:e=>{let t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(!t)return;let a=t/1920*100;return e*a}};var i=r,s={name:"PageTable",props:{headerCellStyle:{type:Object,default:()=>({background:"#fafafa",color:"#606266"})},reserveSelection:{type:Boolean,default:!1},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1},pageSize:{type:Number,default:5},pageSizes:{type:Array,default:()=>[5,10,20,30]},treeProps:{type:Object},rowKey:{type:String,default:"id"},defaultExpandAll:{type:Boolean,default:!1}},data(){return{loading:!0,tableData:[],total:0,page:{pageSize:5,pageNum:1},sort:{sort:"create_time",order:"DESC"},current:1}},mounted(){this.page.pageSize=this.pageSize,this.loadTableData()},watch:{tableData(){this.loading=!1},pageSize(){this.page.pageSize=this.pageSize}},methods:{handleSizeChange(e){this.page.pageSize=e,this.loadTableData()},handleCurrentChange(e){this.page.pageNum=e,this.current=e,this.loadTableData()},handleSelectionChange(e){this.$emit("selection-change",e)},handleRowClick(e,t,a){this.$emit("row-click",e,t,a)},handleSortChange(e){const t=e.prop,a="ascending"==e.order?"ASC":"descending"==e.order?"DESC":e.order;this.sort=t?{sort:t,order:a}:{sort:"create_time",order:"DESC"},this.loadTableData()},refresh(){this.page.pageNum=1,this.$emit("refresh",(()=>{this.loadTableData()}))},loadTableData(e,t){i.isEmpty(e)||"reload"!=e||(this.page.pageNum=1,this.current=1),this.loading=!0,this.$emit("load-table-data",{...this.page,...t,...this.sort},(e=>{this.loading=!1,this.tableData=e?e.data:[],this.total=e?e.total:0}))}}},n=s,c=a(1001),u=(0,c.Z)(n,l,o,!1,null,null,null),d=u.exports}}]);
//# sourceMappingURL=889.6ce2f607.js.map