"use strict";(self["webpackChunkbookstore_app"]=self["webpackChunkbookstore_app"]||[]).push([[450],{25450:function(t,e,o){o.r(e),o.d(e,{default:function(){return m}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"detail"},[e("van-nav-bar",{attrs:{"left-arrow":"",title:t.details.name},on:{"click-left":function(e){return t.$router.go(-1)}}}),e("van-image",{staticClass:"img",attrs:{src:"/"+t.details.img}}),e("van-card",{attrs:{price:t.details.price,desc:t.details.author,title:t.details.name},scopedSlots:t._u([{key:"tags",fn:function(){return[e("van-tag",{attrs:{plain:"",size:"large",type:"primary"}},[t._v(t._s(t.details.publisher))]),e("br"),e("van-tag",{attrs:{size:"large",type:"danger"}},[t._v(t._s(t.details.etc.cateName))])]},proxy:!0},{key:"num",fn:function(){return[e("van-tag",{staticClass:"tagFavor",attrs:{size:"large"},on:{click:function(e){return t.toFavor(t.$route.query.id)}}},[1==t.details.etc.isFavor?e("van-icon",{attrs:{name:"star"}}):e("van-icon",{attrs:{name:"star-o"}}),t._v(" "+t._s(t.favor)+" ")],1)]},proxy:!0}])}),e("div",{staticStyle:{"margin-left":"20px",color:"red",float:"left"}},[t._v("简介")]),e("div",{staticClass:"bookDetail",domProps:{innerHTML:t._s(t.details.description)}}),e("van-nav-bar",{attrs:{"left-text":"书籍评价"+t.bookCommentNum},on:{"click-left":function(e){return t.toComment()},"click-right":function(e){return t.toComment()}},scopedSlots:t._u([{key:"right",fn:function(){return[t._v(" 查看全部 "),e("van-icon",{attrs:{name:"arrow"}})]},proxy:!0}])}),t._l(t.comments,(function(o,a){return e("div",{key:a,staticClass:"book"},[e("div",{staticStyle:{display:"flex"}},[e("van-image",{staticClass:"img2",attrs:{round:"",src:"user.jpg"}}),e("div",{staticStyle:{"margin-left":"20px","margin-top":"10px"}},[t._v(t._s(o.etc.nickname))])],1),e("div",[e("van-rate",{attrs:{readonly:""},model:{value:o.rate,callback:function(e){t.$set(o,"rate",e)},expression:"comment.rate"}})],1),e("div",[t._v(t._s(o.content))]),e("div",{staticStyle:{"font-size":"14px"}},[t._v(t._s(o.createTime))])])})),e("van-goods-action",[e("van-goods-action-icon",{attrs:{icon:"chat-o",text:"客服"}}),e("van-goods-action-icon",{attrs:{icon:"cart-o",text:"购物车",to:"/cart",badge:t.cartNum}}),e("van-goods-action-icon",{attrs:{icon:"star-o",text:"收藏",to:"/favor",badge:t.favorNum}}),e("van-goods-action-button",{attrs:{type:"danger",text:"加入购物车"},on:{click:function(e){return t.toShopCart(t.$route.query.id)}}})],1)],2)},r=[],n=(o(16743),o(88848)),s=(o(63391),o(5348)),i=(o(57658),o(7877)),c={name:"datail",data:function(){return{details:[],comments:[]}},methods:{toShopCart(t){let e=this;const o=localStorage.getItem("Authorization");o?i.Z.add("/cart/addById",t).then((t=>{console.log(t.data),(0,n.Z)("添加成功"),e.$store.dispatch("setCartNum")})):s.Z.confirm({message:"尚未登录，需要登录",confirmButtonText:"前往登录",cancelButtonText:"留在当前页"}).then((()=>{e.$router.replace("/login"),(0,n.Z)("请登录")})).catch((()=>{}))},toFavor(t){const e=localStorage.getItem("Authorization");let o=this;e?i.Z.add("/favor/addById",t).then((e=>{500==e.statusCode?i.Z.deleteByIds("/favor/deleteByIds",t).then((t=>{(0,n.Z)("取消收藏成功"),o.$store.dispatch("setFavorNum"),o.details.etc.isFavor=0})):200==e.statusCode&&((0,n.Z)("收藏成功"),o.$store.dispatch("setFavorNum"),o.details.etc.isFavor=1)})):s.Z.confirm({message:"尚未登录，需要登录",confirmButtonText:"前往登录",cancelButtonText:"留在当前页"}).then((()=>{o.$router.replace("/login"),(0,n.Z)("请登录")})).catch((()=>{}))},toComment(){this.$router.push({path:"/bookComment",query:{bookId:this.details.id}})}},mounted:function(){let t=this,e=this.$route.query.id;i.Z.getBookById("/book/getBookById",e).then((o=>{t.details=o.data,i.Z.getCommentByBookId("/comment/getByBookId",e).then((e=>{console.log(e),t.$store.dispatch("setCartNum"),t.$store.dispatch("setFavorNum"),200==e.statusCode?(t.comments=e.data.slice(0,3),t.$store.commit("setbookCommentNum",e.data.length)):t.$store.commit("setbookCommentNum",0)}))}))},computed:{cartNum:function(){let t=this.$store.getters.getCartNum;return t>0?t:""},favorNum:function(){let t=this.$store.getters.getFavorNum;return t>0?t:""},bookCommentNum:function(){let t=this.$store.getters.getbookCommentNum;return t>0?"("+t+")":"(0)"},favor:function(){return 0==this.details.etc.isFavor?"收藏书籍":"取消收藏"}}},l=c,u=o(1001),d=(0,u.Z)(l,a,r,!1,null,"5297d68e",null),m=d.exports}}]);
//# sourceMappingURL=450.b15cddbc.js.map